import{d as U,u as B,a as N,r as m,s as c,c as b,b as t,e as p,f as R,w as T,g as E,h as j,i as l,v as n,k as u,t as x,l as D,n as I,q as g}from"./index-eOxYirCB.js";const _={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},A={class:"max-w-md w-full space-y-8"},F={class:"mt-2 text-center text-sm text-gray-600"},$={class:"space-y-4"},z={class:"flex space-x-2"},G=["disabled"],H=["disabled"],J={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},O=U({name:"RegisterPage",__name:"index",setup(K){const y=I(),{register:w,sendRegistrationCode:C,loading:d}=B(),{success:f,error:i}=N(),r=m({username:"",email:"",password:"",confirmPassword:"",verificationCode:""}),a=m(0),v=m(!1),k=c(()=>r.value.username.trim()!==""&&r.value.email.trim()!==""&&r.value.password.trim()!==""&&r.value.confirmPassword.trim()!==""&&r.value.verificationCode.trim()!==""&&r.value.password===r.value.confirmPassword),h=c(()=>r.value.email.trim()!==""&&a.value===0),P=c(()=>a.value>0?`${a.value}s后重发`:"发送验证码"),V=async()=>{if(!r.value.email){i("请先输入邮箱地址");return}v.value=!0;try{await C(r.value.email),f("验证码已发送到您的邮箱"),M()}catch(s){const e=s instanceof Error?s.message:"发送验证码失败，请稍后重试";i(e)}finally{v.value=!1}},q=async()=>{if(r.value.password!==r.value.confirmPassword){i("两次输入的密码不一致");return}try{await w({username:r.value.username,email:r.value.email,password:r.value.password,code:r.value.verificationCode}),f("注册成功！即将跳转到登录页面"),setTimeout(()=>{y.push("/login")},2e3)}catch(s){const e=s instanceof Error?s.message:"注册失败，请稍后重试";i(e)}},M=()=>{a.value=60;const s=setInterval(()=>{a.value--,a.value<=0&&clearInterval(s)},1e3)};return(s,e)=>{const S=E("router-link");return g(),b("div",_,[t("div",A,[t("div",null,[e[7]||(e[7]=t("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"},"创建新账户",-1)),t("p",F,[e[6]||(e[6]=p(" 或者 ")),R(S,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500"},{default:T(()=>e[5]||(e[5]=[p(" 登录已有账户 ")])),_:1,__:[5]})])]),t("form",{class:"mt-8 space-y-6",onSubmit:j(q,["prevent"])},[t("div",$,[t("div",null,[e[8]||(e[8]=t("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"用户名",-1)),l(t("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=o=>r.value.username=o),name:"username",type:"text",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入用户名"},null,512),[[n,r.value.username]])]),t("div",null,[e[9]||(e[9]=t("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"邮箱地址",-1)),l(t("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>r.value.email=o),name:"email",type:"email",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入邮箱地址"},null,512),[[n,r.value.email]])]),t("div",null,[e[10]||(e[10]=t("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"密码",-1)),l(t("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=o=>r.value.password=o),name:"password",type:"password",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入密码（6-20位）"},null,512),[[n,r.value.password]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700"},"确认密码",-1)),l(t("input",{id:"confirmPassword","onUpdate:modelValue":e[3]||(e[3]=o=>r.value.confirmPassword=o),name:"confirmPassword",type:"password",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请再次输入密码"},null,512),[[n,r.value.confirmPassword]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"verificationCode",class:"block text-sm font-medium text-gray-700"},"验证码",-1)),t("div",z,[l(t("input",{id:"verificationCode","onUpdate:modelValue":e[4]||(e[4]=o=>r.value.verificationCode=o),name:"verificationCode",type:"text",required:"",class:"flex-1 mt-1 appearance-none relative block px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入验证码"},null,512),[[n,r.value.verificationCode]]),t("button",{type:"button",onClick:V,disabled:!h.value||u(d),class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"},x(P.value),9,G)])])]),t("div",null,[t("button",{type:"submit",disabled:u(d)||!k.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[u(d)?(g(),b("span",J,e[13]||(e[13]=[t("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):D("",!0),p(" "+x(u(d)?"注册中...":"注册"),1)],8,H)])],32)])])}}});export{O as default};
