import{d as k,u as I,a as N,r as B,o as L,c as p,b as t,e as l,f as b,w as f,g as S,h as V,i as m,v as x,j as D,k as c,l as T,t as C,S as u,m as d,n as G,p as O,q as v,E as j}from"./index-eOxYirCB.js";const q={class:"w-screen min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},A={class:"max-w-md w-full space-y-8"},P={class:"mt-2 text-center text-sm text-gray-600"},U={class:"space-y-4"},Y={class:"flex items-center justify-between"},F={class:"flex items-center"},K={class:"text-sm"},X=["disabled"],z={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},Q=k({name:"LoginPage",__name:"index",setup(H){const g=G(),y=O(),{login:w,loading:o}=I(),{success:E,error:i}=N(),s=B({account:"",password:"",remember:!1}),_=()=>{if(s.value.remember){const r={account:s.value.account,password:s.value.password};u.setItem(d.REMEMBER_LOGIN,r,{encrypt:!0,expiry:30*j.DAY})}else u.removeItem(d.REMEMBER_LOGIN)},M=()=>{try{const r=u.getItem(d.REMEMBER_LOGIN);r&&(s.value.account=r.account||"",s.value.password=r.password||"",s.value.remember=!0)}catch(r){console.error("恢复记住我信息失败:",r),u.removeItem(d.REMEMBER_LOGIN)}},h=async()=>{if(R()){o.value=!0;try{const r={account:s.value.account,password:s.value.password};await w(r),_(),E("登录成功！正在跳转...",2e3),await new Promise(n=>setTimeout(n,100));const e=y.query.redirect||"/dashboard";await g.push(e)}catch(r){console.error("登录错误详情:",r);const e=r instanceof Error?r.message:"登录失败，请检查账户名和密码";i(e)}finally{o.value=!1}}};L(()=>{M()});const R=()=>s.value.account.trim()?s.value.password.trim()?!0:(i("请输入密码"),!1):(i("请输入账户名或邮箱"),!1);return(r,e)=>{const n=S("router-link");return v(),p("div",q,[t("div",A,[t("div",null,[e[5]||(e[5]=t("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"},"登录您的账户",-1)),t("p",P,[e[4]||(e[4]=l(" 或者 ")),b(n,{to:"/register",class:"font-medium text-blue-600 hover:text-blue-500"},{default:f(()=>e[3]||(e[3]=[l(" 创建新账户 ")])),_:1,__:[3]})])]),t("form",{class:"mt-8 space-y-6",onSubmit:V(h,["prevent"])},[t("div",U,[t("div",null,[e[6]||(e[6]=t("label",{for:"account",class:"block text-sm font-medium text-gray-700"},"账户名/邮箱",-1)),m(t("input",{id:"account","onUpdate:modelValue":e[0]||(e[0]=a=>s.value.account=a),name:"account",type:"text",autocomplete:"username",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入用户名或邮箱地址"},null,512),[[x,s.value.account]])]),t("div",null,[e[7]||(e[7]=t("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"密码",-1)),m(t("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=a=>s.value.password=a),name:"password",type:"password",autocomplete:"current-password",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入密码"},null,512),[[x,s.value.password]])])]),t("div",Y,[t("div",F,[m(t("input",{id:"remember-me","onUpdate:modelValue":e[2]||(e[2]=a=>s.value.remember=a),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[D,s.value.remember]]),e[8]||(e[8]=t("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," 记住我 ",-1))]),t("div",K,[b(n,{to:"/forgot-password",class:"font-medium text-blue-600 hover:text-blue-500"},{default:f(()=>e[9]||(e[9]=[l(" 忘记密码？ ")])),_:1,__:[9]})])]),t("div",null,[t("button",{type:"submit",disabled:c(o),class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[c(o)?(v(),p("span",z,e[10]||(e[10]=[t("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):T("",!0),l(" "+C(c(o)?"登录中...":"登录"),1)],8,X)])],32)])])}}});export{Q as default};
