import{d as B,u as N,r as i,s as b,c as u,b as e,l as w,h as S,i as m,v as c,k as p,t as v,e as x,f as T,w as U,g as E,n as R,q as f}from"./index-eOxYirCB.js";const j={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},D={class:"max-w-md w-full space-y-8"},F={class:"space-y-4"},I={class:"flex space-x-2"},M=["disabled"],A=["disabled"],$={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},z={class:"mt-6 text-center"},G={key:0,class:"mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded"},H={key:1,class:"mt-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded"},L=B({name:"ForgotPasswordPage",__name:"index",setup(J){const y=R(),{resetPassword:g,sendResetPasswordCode:_,loading:d}=N(),t=i({email:"",verificationCode:"",newPassword:"",confirm_password:""}),r=i(""),n=i(""),l=i(0),k=b(()=>t.value.email.trim()!==""&&t.value.verificationCode.trim()!==""&&t.value.newPassword.trim()!==""&&t.value.confirm_password.trim()!==""&&t.value.newPassword===t.value.confirm_password),h=b(()=>t.value.email.trim()!==""&&l.value===0),C=b(()=>l.value>0?`${l.value}s后重发`:"发送验证码"),P=async()=>{try{if(r.value="",!t.value.email){r.value="请先输入邮箱地址";return}await _(t.value.email),n.value="验证码已发送到您的邮箱",l.value=60;const s=setInterval(()=>{l.value--,l.value<=0&&clearInterval(s)},1e3)}catch(s){r.value=s instanceof Error?s.message:"发送验证码失败"}},V=async()=>{if(t.value.newPassword!==t.value.confirm_password){r.value="两次输入的密码不一致";return}try{r.value="",n.value="",await g({email:t.value.email,code:t.value.verificationCode,newPassword:t.value.newPassword}),n.value="密码重置成功！即将跳转到登录页面",setTimeout(()=>{y.push("/login")},2e3)}catch(s){r.value=s instanceof Error?s.message:"重置密码失败，请检查输入信息"}};return(s,o)=>{const q=E("router-link");return f(),u("div",j,[e("div",D,[o[10]||(o[10]=e("div",null,[e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"},"重置密码"),e("p",{class:"mt-2 text-center text-sm text-gray-600"}," 请输入您的邮箱地址，我们将发送验证码到您的邮箱 ")],-1)),e("form",{class:"mt-8 space-y-6",onSubmit:S(V,["prevent"])},[e("div",F,[e("div",null,[o[4]||(o[4]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"邮箱地址",-1)),m(e("input",{id:"email","onUpdate:modelValue":o[0]||(o[0]=a=>t.value.email=a),name:"email",type:"email",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入注册时的邮箱地址"},null,512),[[c,t.value.email]])]),e("div",null,[o[5]||(o[5]=e("label",{for:"verificationCode",class:"block text-sm font-medium text-gray-700"},"验证码",-1)),e("div",I,[m(e("input",{id:"verificationCode","onUpdate:modelValue":o[1]||(o[1]=a=>t.value.verificationCode=a),name:"verificationCode",type:"text",required:"",class:"flex-1 mt-1 appearance-none relative block px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入验证码"},null,512),[[c,t.value.verificationCode]]),e("button",{type:"button",onClick:P,disabled:!h.value||p(d),class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"},v(C.value),9,M)])]),e("div",null,[o[6]||(o[6]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700"},"新密码",-1)),m(e("input",{id:"newPassword","onUpdate:modelValue":o[2]||(o[2]=a=>t.value.newPassword=a),name:"newPassword",type:"password",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请输入新密码（6-20位）"},null,512),[[c,t.value.newPassword]])]),e("div",null,[o[7]||(o[7]=e("label",{for:"confirm_password",class:"block text-sm font-medium text-gray-700"},"确认新密码",-1)),m(e("input",{id:"confirm_password","onUpdate:modelValue":o[3]||(o[3]=a=>t.value.confirm_password=a),name:"confirm_password",type:"password",required:"",class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"请再次输入新密码"},null,512),[[c,t.value.confirm_password]])])]),e("div",null,[e("button",{type:"submit",disabled:p(d)||!k.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[p(d)?(f(),u("span",$,o[8]||(o[8]=[e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):w("",!0),x(" "+v(p(d)?"重置中...":"重置密码"),1)],8,A)])],32),e("div",z,[T(q,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500"},{default:U(()=>o[9]||(o[9]=[x(" 返回登录 ")])),_:1,__:[9]})]),r.value?(f(),u("div",G,v(r.value),1)):w("",!0),n.value?(f(),u("div",H,v(n.value),1)):w("",!0)])])}}});export{L as default};
