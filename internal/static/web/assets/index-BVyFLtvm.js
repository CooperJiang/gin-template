import{d as R,u as S,a as T,i as m,j as C,m as j,c as n,b as e,n as y,h as w,f as h,w as z,r as D,e as l,p as I,t as g,z as A,q as $,s as p,v,y as F,o as i}from"./index-BYj9fpU8.js";const H={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},L={class:"max-w-md w-full space-y-8"},G={class:"mt-2 text-center text-sm text-gray-600"},J={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},K={class:"flex"},O={class:"flex-shrink-0"},Q={class:"ml-3"},W={class:"text-red-800"},X={key:1,class:"bg-green-50 border border-green-200 rounded-md p-4"},Y={class:"flex"},Z={class:"flex-shrink-0"},ee={class:"ml-3"},se={class:"text-green-800"},te={class:"space-y-4"},oe=["disabled"],le=["disabled"],re=["disabled"],ae=["disabled"],de={class:"mt-1 flex space-x-2"},ne=["disabled"],ie=["disabled"],ue={key:0},ce={key:1},me={key:2},pe=["disabled"],ve={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},xe=R({__name:"index",setup(be){const V=F(),{register:P,sendRegistrationCode:M,loading:d}=S(),{success:_,error:k}=T(),t=m({username:"",email:"",password:"",confirmPassword:"",code:""}),o=m(""),b=m(""),f=m(!1),u=m(0);let c=null;const x=C(()=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value.email)),q=C(()=>t.value.username.trim()!==""&&t.value.email.trim()!==""&&t.value.password.trim()!==""&&t.value.confirmPassword.trim()!==""&&t.value.code.trim()!==""&&t.value.password===t.value.confirmPassword&&x.value),U=async()=>{try{if(o.value="",!t.value.email.trim()){o.value="请输入邮箱地址";return}if(!x.value){o.value="请输入有效的邮箱地址";return}f.value=!0,await M(t.value.email.trim()),_("验证码已发送到您的邮箱"),B()}catch(r){const s=r instanceof Error?r.message:"发送验证码失败";o.value=s,k(s)}finally{f.value=!1}},B=()=>{u.value=60,c=setInterval(()=>{u.value--,u.value<=0&&(clearInterval(c),c=null)},1e3)},E=async()=>{try{if(o.value="",b.value="",!t.value.username.trim()){o.value="请输入用户名";return}if(t.value.username.trim().length<3){o.value="用户名长度不能少于3位";return}if(!t.value.email.trim()){o.value="请输入邮箱地址";return}if(!x.value){o.value="请输入有效的邮箱地址";return}if(!t.value.password.trim()){o.value="请输入密码";return}if(t.value.password.length<6){o.value="密码长度不能少于6位";return}if(t.value.password!==t.value.confirmPassword){o.value="两次输入的密码不一致";return}if(!t.value.code.trim()){o.value="请输入验证码";return}const r={username:t.value.username.trim(),email:t.value.email.trim(),password:t.value.password.trim(),code:t.value.code.trim()};await P(r),b.value="注册成功！请登录您的账户",_("注册成功！"),setTimeout(()=>{V.push("/login")},2e3)}catch(r){const s=r instanceof Error?r.message:"注册失败，请重试";o.value=s,k(s)}};return j(()=>{c&&clearInterval(c)}),(r,s)=>{const N=D("router-link");return i(),n("div",H,[e("div",L,[e("div",null,[s[7]||(s[7]=e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," 创建新账户 ",-1)),e("p",G,[s[6]||(s[6]=w(" 已有账户？ ")),h(N,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500"},{default:z(()=>s[5]||(s[5]=[w(" 立即登录 ")])),_:1,__:[5]})])]),o.value?(i(),n("div",J,[e("div",K,[e("div",O,[h(l(I),{class:"h-5 w-5 text-red-400"})]),e("div",Q,[e("p",W,g(o.value),1)])])])):y("",!0),b.value?(i(),n("div",X,[e("div",Y,[e("div",Z,[h(l(A),{class:"h-5 w-5 text-green-400"})]),e("div",ee,[e("p",se,g(b.value),1)])])])):y("",!0),e("form",{class:"mt-8 space-y-6",onSubmit:$(E,["prevent"])},[e("div",te,[e("div",null,[s[8]||(s[8]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"用户名",-1)),p(e("input",{id:"username","onUpdate:modelValue":s[0]||(s[0]=a=>t.value.username=a),type:"text",required:"",disabled:l(d),class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"请输入用户名"},null,8,oe),[[v,t.value.username]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"邮箱",-1)),p(e("input",{id:"email","onUpdate:modelValue":s[1]||(s[1]=a=>t.value.email=a),type:"email",required:"",disabled:l(d),class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"请输入邮箱"},null,8,le),[[v,t.value.email]])]),e("div",null,[s[10]||(s[10]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"密码",-1)),p(e("input",{id:"password","onUpdate:modelValue":s[2]||(s[2]=a=>t.value.password=a),type:"password",required:"",disabled:l(d),class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"请输入密码"},null,8,re),[[v,t.value.password]])]),e("div",null,[s[11]||(s[11]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700"},"确认密码",-1)),p(e("input",{id:"confirmPassword","onUpdate:modelValue":s[3]||(s[3]=a=>t.value.confirmPassword=a),type:"password",required:"",disabled:l(d),class:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"请再次输入密码"},null,8,ae),[[v,t.value.confirmPassword]])]),e("div",null,[s[12]||(s[12]=e("label",{for:"code",class:"block text-sm font-medium text-gray-700"},"验证码",-1)),e("div",de,[p(e("input",{id:"code","onUpdate:modelValue":s[4]||(s[4]=a=>t.value.code=a),type:"text",required:"",disabled:l(d),class:"flex-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"请输入验证码"},null,8,ne),[[v,t.value.code]]),e("button",{type:"button",disabled:f.value||u.value>0||!x.value,onClick:U,class:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[f.value?(i(),n("span",ue,"发送中...")):u.value>0?(i(),n("span",ce,g(u.value)+"s",1)):(i(),n("span",me,"发送验证码"))],8,ie)])])]),e("div",null,[e("button",{type:"submit",disabled:l(d)||!q.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[l(d)?(i(),n("span",ve,s[13]||(s[13]=[e("svg",{class:"animate-spin h-5 w-5 text-blue-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):y("",!0),w(" "+g(l(d)?"注册中...":"注册"),1)],8,pe)])],32)])])}}});export{xe as default};
