# ğŸš€ éƒ¨ç½²æŒ‡å—

æœ¬é¡¹ç›®æä¾›äº†åŸºäº Makefile çš„ä¸€é”®éƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼Œç®€å•é«˜æ•ˆã€‚

## ğŸ“‹ å¿«é€Ÿéƒ¨ç½² (3æ­¥æå®š)

### 1ï¸âƒ£ é…ç½®éƒ¨ç½²å‚æ•° (é¦–æ¬¡)
```bash
make deploy-config
```
**è¾“å…¥ä»¥ä¸‹ä¿¡æ¯:**
- åº”ç”¨åç§° (é»˜è®¤: template)
- æœåŠ¡å™¨åœ°å€ (å¿…å¡«)
- SSHç”¨æˆ·å (é»˜è®¤: root)
- SSHç«¯å£ (é»˜è®¤: 22)
- éƒ¨ç½²ç›®å½• (é»˜è®¤: /opt/myapp)
- SSHå¯†é’¥è·¯å¾„ (è‡ªåŠ¨æ£€æµ‹)
- éƒ¨ç½²ç¯å¢ƒ (prod/test/devï¼Œé»˜è®¤: prod)

### 2ï¸âƒ£ åˆå§‹åŒ–æœåŠ¡å™¨ (é¦–æ¬¡)
```bash
make deploy-setup
```

### 3ï¸âƒ£ ä¸€é”®éƒ¨ç½²
```bash
make build-deploy
```

**ğŸ‰ å®Œæˆï¼è®¿é—®æ‚¨çš„åº”ç”¨å³å¯ï¼**

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### æ„å»ºå‘½ä»¤
```bash
make build          # æ„å»ºé¡¹ç›® (åŒ…å«å‰ç«¯ç‰ˆæœ¬è‡ªåŠ¨æ›´æ–°)
```

### éƒ¨ç½²å‘½ä»¤
```bash
make build-deploy    # ğŸš€ ä¸€é”®æ„å»ºå¹¶éƒ¨ç½²
make deploy          # ä»…éƒ¨ç½² (éœ€å…ˆè¿è¡Œ make build)
```

### ç®¡ç†å‘½ä»¤
```bash
make deploy-status   # æŸ¥çœ‹åº”ç”¨çŠ¶æ€
make deploy-logs     # æŸ¥çœ‹åº”ç”¨æ—¥å¿—
make deploy-restart  # é‡å¯åº”ç”¨
make deploy-rollback # å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
```

### æŸ¥çœ‹é…ç½®
```bash
make deploy-check    # æŸ¥çœ‹å½“å‰éƒ¨ç½²é…ç½®
```

---

## ğŸ”§ ç‰ˆæœ¬ç®¡ç†ç‰¹æ€§

### Admin åå°ç‰ˆæœ¬è‡ªåŠ¨æ›´æ–°
- âœ… æ¯æ¬¡æ„å»ºè‡ªåŠ¨é€’å¢ç‰ˆæœ¬å· (1.0.1 â†’ 1.0.2 â†’ ... â†’ 1.1.0)
- âœ… æ˜¾ç¤ºæ„å»ºæ—¶é—´ï¼Œæ–¹ä¾¿ç¡®è®¤éƒ¨ç½²æ˜¯å¦æˆåŠŸ
- âœ… åœ¨ç®¡ç†åå°åº•éƒ¨æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯

### å¿«é€Ÿéƒ¨ç½²ç‰¹æ€§
- âœ… **2-3ç§’åˆ‡æ¢æ—¶é—´** - å‡ ä¹é›¶åœæœºéƒ¨ç½²
- âœ… **ç‰ˆæœ¬ç®¡ç†** - ä¿ç•™æœ€è¿‘5ä¸ªç‰ˆæœ¬ï¼Œæ”¯æŒä¸€é”®å›æ»š
- âœ… **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨å¤„ç†ç«¯å£å ç”¨å’Œè¿›ç¨‹ç®¡ç†
- âœ… **å¤šç¯å¢ƒæ”¯æŒ** - prod/test/devç¯å¢ƒé…ç½®

---

## ğŸ“‚ éƒ¨ç½²åŒ…è¯´æ˜

è¿è¡Œ `make build` åä¼šç”Ÿæˆï¼š
- `./release/template_prod_package.tar.gz` - å®Œæ•´éƒ¨ç½²åŒ…

**åŒ…å«å†…å®¹:**
- ç¼–è¯‘å¥½çš„ Go äºŒè¿›åˆ¶æ–‡ä»¶ (åµŒå…¥å‰ç«¯é™æ€æ–‡ä»¶)
- ç¯å¢ƒé…ç½®æ–‡ä»¶ (config.prod.yaml)
- å¯åŠ¨è„šæœ¬ (run.sh)

---

## ğŸŒ å¤šç¯å¢ƒéƒ¨ç½²

```bash
# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
DEPLOY_ENV=test make build-deploy

# éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ
DEPLOY_ENV=dev make build-deploy
```

---

## ğŸ” SSHé…ç½®

### å¦‚æœæ²¡æœ‰SSHå¯†é’¥
```bash
# ç”Ÿæˆå¯†é’¥
ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa

# å¤åˆ¶åˆ°æœåŠ¡å™¨
ssh-copy-id root@your-server.com
```

### æ”¯æŒçš„å¯†é’¥ç±»å‹
- `~/.ssh/id_rsa` (RSA)
- `~/.ssh/id_ed25519` (Ed25519)  
- `~/.ssh/id_ecdsa` (ECDSA)

---

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
```bash
# SSHè¿æ¥å¤±è´¥
chmod 600 ~/.ssh/id_rsa
ssh root@your-server.com  # æµ‹è¯•è¿æ¥

# åº”ç”¨å¯åŠ¨å¤±è´¥
make deploy-logs          # æŸ¥çœ‹æ—¥å¿—
make deploy-status        # æŸ¥çœ‹çŠ¶æ€

# é‡æ–°åˆå§‹åŒ–æœåŠ¡å™¨
make deploy-setup         # é‡æ–°è®¾ç½®ç¯å¢ƒ
```

### ç«¯å£å†²çª
å¦‚æœé‡åˆ°ç«¯å£å ç”¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†æ—§è¿›ç¨‹ã€‚

---

## ğŸ’¡ æœ€ä½³å®è·µ

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æµç¨‹
```bash
# 1. é¦–æ¬¡éƒ¨ç½²
make deploy-config        # é…ç½®å‚æ•°
make deploy-setup         # åˆå§‹åŒ–æœåŠ¡å™¨
make build-deploy         # éƒ¨ç½²åº”ç”¨

# 2. æ—¥å¸¸æ›´æ–°
make build-deploy         # ä¸€é”®æ›´æ–°éƒ¨ç½²

# 3. ç´§æ€¥å›æ»š
make deploy-rollback      # å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
```

### æ£€æŸ¥éƒ¨ç½²ç»“æœ
- è®¿é—®ç®¡ç†åå°åº•éƒ¨æŸ¥çœ‹ç‰ˆæœ¬å·æ˜¯å¦æ›´æ–°
- è¿è¡Œ `make deploy-status` ç¡®è®¤åº”ç”¨è¿è¡ŒçŠ¶æ€
- è¿è¡Œ `make deploy-logs` æŸ¥çœ‹å¯åŠ¨æ—¥å¿—

---

**ğŸ¯ ä¸€ä¸ªå‘½ä»¤æå®šéƒ¨ç½²ï¼š`make build-deploy`** 